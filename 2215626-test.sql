/*
This SQL script calculates weekly user-level metrics for a transactional business. It calculates the number of transactions each user created in a given week, as well as over their lifetime up to that week. It also uses these numbers to create flags for new, churned, reactivated, and retained users.
*/